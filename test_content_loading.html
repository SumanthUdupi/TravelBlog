<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Content Loading Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            color: #333;
        }
        
        h1 {
            color: #d45d00;
            border-bottom: 2px solid #d45d00;
            padding-bottom: 10px;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .test-section h2 {
            color: #d45d00;
            margin-top: 0;
        }
        
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 3px;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        button {
            background-color: #d45d00;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 3px;
            cursor: pointer;
            margin: 5px 0;
        }
        
        button:hover {
            background-color: #b85000;
        }
        
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
        
        .content-preview {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 3px;
            margin: 10px 0;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <h1>Blog Content Loading Test</h1>
    
    <div class="test-section">
        <h2>Markdown Parser Test</h2>
        <p>This test validates that the markdown parser can properly load and parse content.</p>
        
        <button id="testMarkdownLoading">Test Markdown Loading</button>
        <button id="testFallbackContent">Test Fallback Content</button>
        
        <div id="testResults"></div>
    </div>
    
    <div class="test-section">
        <h2>File Loading Test</h2>
        <p>This test checks if the system can load actual markdown files.</p>
        
        <button id="testFileLoading">Test File Loading</button>
        
        <div id="fileResults"></div>
    </div>
    
    <div class="test-section">
        <h2>Content Preview</h2>
        <p>Preview of loaded content:</p>
        
        <div id="contentPreview" class="content-preview">
            <p>Click the test buttons above to see content previews.</p>
        </div>
    </div>
    
    <script type="module">
        // Import the markdown parser
        import MarkdownParser from './js/markdown-parser.js';
        
        // Test markdown loading
        document.getElementById('testMarkdownLoading').addEventListener('click', async () => {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = '<p>Testing markdown loading...</p>';
            
            try {
                // Test with a sample markdown string
                const sampleMarkdown = `# Test Heading\n\nThis is a **test** paragraph with *italic* text.\n\n- List item 1\n- List item 2\n\n> This is a blockquote`;
                
                const html = MarkdownParser.parseMarkdown(sampleMarkdown);
                
                resultsDiv.innerHTML = `
                    <div class="test-result success">
                        <strong>✅ SUCCESS:</strong> Markdown parser is working correctly.
                    </div>
                    <div class="test-result info">
                        <strong>Parsed HTML:</strong>
                        <pre>${escapeHtml(html)}</pre>
                    </div>
                `;
                
                document.getElementById('contentPreview').innerHTML = html;
                
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="test-result error">
                        <strong>❌ ERROR:</strong> ${error.message}
                    </div>
                `;
            }
        });
        
        // Test fallback content
        document.getElementById('testFallbackContent').addEventListener('click', async () => {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = '<p>Testing fallback content...</p>';
            
            try {
                // Test loading a non-existent file to trigger fallback
                const content = await MarkdownParser.loadMarkdownFile('Blog/nonexistent.md');
                
                resultsDiv.innerHTML = `
                    <div class="test-result success">
                        <strong>✅ SUCCESS:</strong> Fallback content loaded correctly.
                    </div>
                    <div class="test-result info">
                        <strong>Content Preview:</strong>
                        <pre>${escapeHtml(content.substring(0, 200))}...</pre>
                    </div>
                `;
                
                document.getElementById('contentPreview').innerHTML = content;
                
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="test-result error">
                        <strong>❌ ERROR:</strong> ${error.message}
                    </div>
                `;
            }
        });
        
        // Test actual file loading
        document.getElementById('testFileLoading').addEventListener('click', async () => {
            const resultsDiv = document.getElementById('fileResults');
            resultsDiv.innerHTML = '<p>Testing actual file loading...</p>';
            
            try {
                // Test loading actual blog content files
                const testFiles = [
                    'Blog/raw/Jai Jagannath.md',
                    'Blog/raw/odisha_sacred_odyssey.md',
                    'Blog/research/Chausath Yogini.md'
                ];
                
                let allResults = '<h3>File Loading Results:</h3>';
                
                for (const filePath of testFiles) {
                    try {
                        const content = await MarkdownParser.loadMarkdownFile(filePath);
                        
                        if (content && content.trim() && !content.startsWith('# Error')) {
                            allResults += `
                                <div class="test-result success">
                                    <strong>✅ ${filePath}</strong>: Loaded successfully (${content.length} characters)
                                </div>
                            `;
                        } else {
                            allResults += `
                                <div class="test-result warning">
                                    <strong>⚠️ ${filePath}</strong>: Fallback content used
                                </div>
                            `;
                        }
                    } catch (fileError) {
                        allResults += `
                            <div class="test-result error">
                                <strong>❌ ${filePath}</strong>: ${fileError.message}
                            </div>
                        `;
                    }
                }
                
                resultsDiv.innerHTML = allResults;
                
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="test-result error">
                        <strong>❌ ERROR:</strong> ${error.message}
                    </div>
                `;
            }
        });
        
        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        console.log('Content loading test initialized');
    </script>
</body>
</html>